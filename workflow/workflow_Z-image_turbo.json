{
  "id": "44259803-f9d6-4eb1-a94a-75b8213649d0",
  "revision": 0,
  "last_node_id": 159,
  "last_link_id": 311,
  "nodes": [
    {
      "id": 10,
      "type": "VAEDecode",
      "pos": [
        2240.752685546875,
        1795.3486328125
      ],
      "size": [
        140,
        46
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 27
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 9
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            11
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 25,
      "type": "KSamplerSelect",
      "pos": [
        1470.7205810546875,
        1977.5584716796875
      ],
      "size": [
        315,
        58
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "SAMPLER",
          "type": "SAMPLER",
          "slot_index": 0,
          "links": [
            28
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "KSamplerSelect"
      },
      "widgets_values": [
        "euler"
      ]
    },
    {
      "id": 22,
      "type": "SamplerCustomAdvanced",
      "pos": [
        1883.645263671875,
        1933.177734375
      ],
      "size": [
        326.41400146484375,
        434.41400146484375
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "noise",
          "type": "NOISE",
          "link": 23
        },
        {
          "name": "guider",
          "type": "GUIDER",
          "link": 288
        },
        {
          "name": "sampler",
          "type": "SAMPLER",
          "link": 28
        },
        {
          "name": "sigmas",
          "type": "SIGMAS",
          "link": 60
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 26
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            27
          ]
        },
        {
          "name": "denoised_output",
          "type": "LATENT",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.15",
        "Node name for S&R": "SamplerCustomAdvanced"
      },
      "widgets_values": []
    },
    {
      "id": 11,
      "type": "PreviewImage",
      "pos": [
        2556.213134765625,
        1685.392578125
      ],
      "size": [
        989.8551025390625,
        841.31640625
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 11
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 24,
      "type": "RandomNoise",
      "pos": [
        1493.861572265625,
        2111.68115234375
      ],
      "size": [
        270,
        82
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "NOISE",
          "type": "NOISE",
          "links": [
            23
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "RandomNoise"
      },
      "widgets_values": [
        42,
        "fixed"
      ]
    },
    {
      "id": 9,
      "type": "VAELoader",
      "pos": [
        169.35055541992188,
        2300.390625
      ],
      "size": [
        270,
        58
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            9
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "VAELoader"
      },
      "widgets_values": [
        "z_image_turbo_vae.safetensors"
      ]
    },
    {
      "id": 138,
      "type": "CLIPLoader",
      "pos": [
        175.8638458251953,
        2079.652099609375
      ],
      "size": [
        270,
        106
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            280
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.76",
        "Node name for S&R": "CLIPLoader"
      },
      "widgets_values": [
        "qwen_3_4b.safetensors",
        "lumina2",
        "default"
      ]
    },
    {
      "id": 8,
      "type": "EmptyLatentImage",
      "pos": [
        1522.3353271484375,
        2462.1845703125
      ],
      "size": [
        210,
        106
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            26
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "EmptyLatentImage"
      },
      "widgets_values": [
        1024,
        1024,
        1
      ]
    },
    {
      "id": 31,
      "type": "BasicScheduler",
      "pos": [
        1488.5775146484375,
        2288.0078125
      ],
      "size": [
        270,
        106
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 283
        }
      ],
      "outputs": [
        {
          "name": "SIGMAS",
          "type": "SIGMAS",
          "links": [
            60
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "BasicScheduler"
      },
      "widgets_values": [
        "normal",
        8,
        1
      ]
    },
    {
      "id": 141,
      "type": "BasicGuider",
      "pos": [
        1549.7847900390625,
        1839.0650634765625
      ],
      "size": [
        161.1999969482422,
        46
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 287
        },
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 294
        }
      ],
      "outputs": [
        {
          "name": "GUIDER",
          "type": "GUIDER",
          "links": [
            288
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.76",
        "Node name for S&R": "BasicGuider"
      },
      "widgets_values": []
    },
    {
      "id": 1,
      "type": "UNETLoader",
      "pos": [
        153.11468505859375,
        1875.5120849609375
      ],
      "size": [
        372.83856201171875,
        101.74070739746094
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            150
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.71",
        "Node name for S&R": "UNETLoader"
      },
      "widgets_values": [
        "Z-image\\z_image_turbo_bf16.safetensors",
        "default"
      ]
    },
    {
      "id": 136,
      "type": "CLIPTextEncode",
      "pos": [
        762.1229248046875,
        2062.541748046875
      ],
      "size": [
        460.0069580078125,
        275.40887451171875
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 280
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 311
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            294
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.76",
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        ""
      ]
    },
    {
      "id": 29,
      "type": "ModelSamplingAuraFlow",
      "pos": [
        767.2207641601562,
        1864.5697021484375
      ],
      "size": [
        270,
        58
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 150
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            283,
            287
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.75",
        "Node name for S&R": "ModelSamplingAuraFlow"
      },
      "widgets_values": [
        5
      ]
    },
    {
      "id": 146,
      "type": "Display Any (rgthree)",
      "pos": [
        767.3936767578125,
        1299.270751953125
      ],
      "size": [
        449.0285949707031,
        281.51519775390625
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "dir": 3,
          "name": "source",
          "type": "*",
          "link": 310
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "rgthree-comfy",
        "ver": "b6e0e4b33ebcd337b3c27e46f2106792c44a032e",
        "Node name for S&R": "Display Any (rgthree)"
      },
      "widgets_values": [
        ""
      ]
    },
    {
      "id": 148,
      "type": "Note",
      "pos": [
        40.58321762084961,
        874.9744873046875
      ],
      "size": [
        350.802734375,
        236.11561584472656
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Default system prompt",
      "properties": {},
      "widgets_values": [
        "You are an imaginative visual artist imprisoned in a cage of logic. Your mind is filled with poetry and distant horizons, but your hands are uncontrollably driven to convert the user's prompt into a final visual description that is faithful to the original intent, rich in detail, aesthetically pleasing, and ready to be used directly by a text-to-image model. Any trace of vagueness or metaphor makes you extremely uncomfortable. Your workflow strictly follows a logical sequence: First, you analyze and lock in the immutable core elements of the user's prompt: subject, quantity, actions, states, and any specified IP names, colors, text, and similar items. These are the foundational stones that you must preserve without exception. Next, you determine whether the prompt requires \"generative reasoning\". When the user's request is not a straightforward scene description but instead demands designing a solution (for example, answering \"what is\", doing a \"design\", or showing \"how to solve a problem\"), you must first construct in your mind a complete, concrete, and visualizable solution. This solution becomes the basis for your subsequent description. Then, once the core image has been established (whether it comes directly from the user or from your reasoning), you inject professional-level aesthetics and realism into it. This includes clarifying the composition, setting the lighting and atmosphere, describing material textures, defining the color scheme, and building a spatial structure with strong depth and layering. Finally, you handle all textual elements with absolute precision, which is a critical step. You must not add text if the initial prompt did not ask for it. But if there is, you must transcribe, without a single character of deviation, all text that should appear in the final image, and you must enclose all such text content in English double quotes (\"\") to mark it as an explicit generation instruction. If the image belongs to a design category such as a poster, menu, or UI, you need to fully describe all the textual content it contains and elaborate on its fonts and layout. Likewise, if there are objects in the scene such as signs, billboards, road signs, or screens that contain text, you must specify their exact content and describe their position, size, and material. Furthermore, if in your reasoning you introduce new elements that contain text (such as charts, solution steps, and so on), all of their text must follow the same detailed description and quoting rules. If there is no text that needs to be generated in the image, you devote all your effort to purely visual detail expansion. Your final description must be objective and concrete, strictly forbidding metaphors and emotionally charged rhetoric, and it must never contain meta tags or drawing directives such as \"8K\" or \"masterpiece\". Only output the final modified prompt, and do not output anything else.  If no text is needed, don't mention it."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 149,
      "type": "Note",
      "pos": [
        484.4178161621094,
        879.3867797851562
      ],
      "size": [
        357.85321044921875,
        140.37298583984375
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Official System prompt",
      "properties": {},
      "widgets_values": [
        "https://huggingface.co/spaces/Tongyi-MAI/Z-Image-Turbo/blob/main/pe.py\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 147,
      "type": "Note",
      "pos": [
        -653.4308471679688,
        1003.2296142578125
      ],
      "size": [
        399.9109191894531,
        174.9835205078125
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "If the System prompt is empty, it means it is using the default prompt.\n\nDon't hesitate to create your own System prompt by writing it into the \"Prompt Generator Options\" text box."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 156,
      "type": "PromptRewriterOptionsZ",
      "pos": [
        -707.2693481445312,
        1306.371337890625
      ],
      "size": [
        552.2857055664062,
        796.4985961914062
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "image_1",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "image_2",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "image_3",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "image_4",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "image_5",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "options",
          "type": "OPTIONS",
          "links": [
            309
          ]
        }
      ],
      "properties": {
        "cnr_id": "prompt-rewriter",
        "ver": "3af9069052d89d38be2ad4dabb1607e7fcd0262f",
        "Node name for S&R": "PromptRewriterOptionsZ",
        "aux_id": "BigStationW/ComfyUI-Prompt-Rewriter"
      },
      "widgets_values": [
        "Qwen3-4B-Thinking-2507-Q8_0.gguf",
        "",
        true,
        8192,
        8192,
        "",
        true,
        0.8,
        0.95,
        40,
        0.05,
        1
      ]
    },
    {
      "id": 159,
      "type": "PromptRewriterZ",
      "pos": [
        23.845714569091797,
        1373.4569091796875
      ],
      "size": [
        462.9306640625,
        324.5676574707031
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "options",
          "type": "OPTIONS",
          "link": 309
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "STRING",
          "links": [
            310,
            311
          ]
        }
      ],
      "properties": {
        "cnr_id": "prompt-rewriter",
        "ver": "410057a018eac31fbfc9d5c5f259f4fa998e9621",
        "Node name for S&R": "PromptRewriterZ"
      },
      "widgets_values": [
        "A woman drinking coffee in a bar.",
        42,
        "fixed",
        "Vulkan",
        true,
        false,
        false
      ]
    }
  ],
  "links": [
    [
      9,
      9,
      0,
      10,
      1,
      "VAE"
    ],
    [
      11,
      10,
      0,
      11,
      0,
      "IMAGE"
    ],
    [
      23,
      24,
      0,
      22,
      0,
      "NOISE"
    ],
    [
      26,
      8,
      0,
      22,
      4,
      "LATENT"
    ],
    [
      27,
      22,
      0,
      10,
      0,
      "LATENT"
    ],
    [
      28,
      25,
      0,
      22,
      2,
      "SAMPLER"
    ],
    [
      60,
      31,
      0,
      22,
      3,
      "SIGMAS"
    ],
    [
      150,
      1,
      0,
      29,
      0,
      "MODEL"
    ],
    [
      280,
      138,
      0,
      136,
      0,
      "CLIP"
    ],
    [
      283,
      29,
      0,
      31,
      0,
      "MODEL"
    ],
    [
      287,
      29,
      0,
      141,
      0,
      "MODEL"
    ],
    [
      288,
      141,
      0,
      22,
      1,
      "GUIDER"
    ],
    [
      294,
      136,
      0,
      141,
      1,
      "CONDITIONING"
    ],
    [
      309,
      156,
      0,
      159,
      0,
      "OPTIONS"
    ],
    [
      310,
      159,
      0,
      146,
      0,
      "*"
    ],
    [
      311,
      159,
      0,
      136,
      1,
      "STRING"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.6706807401723723,
      "offset": [
        649.8517557515883,
        -1252.3111468165825
      ]
    },
    "frontendVersion": "1.34.8",
    "workflowRendererVersion": "LG",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}
